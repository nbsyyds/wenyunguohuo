{"remainingRequest":"D:\\javaProject\\litemall-master\\litemall-admin\\node_modules\\vue-loader\\lib\\index.js??vue-loader-options!D:\\javaProject\\litemall-master\\litemall-admin\\src\\views\\mall\\order.vue?vue&type=style&index=0&id=4a4e50a6&lang=scss&scoped=true","dependencies":[{"path":"D:\\javaProject\\litemall-master\\litemall-admin\\src\\views\\mall\\order.vue","mtime":1703663872000},{"path":"D:\\javaProject\\litemall-master\\litemall-admin\\node_modules\\css-loader\\dist\\cjs.js","mtime":499162500000},{"path":"D:\\javaProject\\litemall-master\\litemall-admin\\node_modules\\vue-loader\\lib\\loaders\\stylePostLoader.js","mtime":499162500000},{"path":"D:\\javaProject\\litemall-master\\litemall-admin\\node_modules\\postcss-loader\\src\\index.js","mtime":499162500000},{"path":"D:\\javaProject\\litemall-master\\litemall-admin\\node_modules\\sass-loader\\dist\\cjs.js","mtime":499162500000},{"path":"D:\\javaProject\\litemall-master\\litemall-admin\\node_modules\\cache-loader\\dist\\cjs.js","mtime":499162500000},{"path":"D:\\javaProject\\litemall-master\\litemall-admin\\node_modules\\vue-loader\\lib\\index.js","mtime":499162500000}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:CgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCi5lbC10YWJsZS0tbWVkaXVtIHRoLCAuZWwtdGFibGUtLW1lZGl1bSB0ZCB7CiAgICBwYWRkaW5nOiAzcHggMDsKfQoKLmVsLWlucHV0LW51bWJlci0tbWVkaXVtIHsKICB3aWR0aDogMTAwJTsKfQoKLm9wZXIgLmVsLWJ1dHRvbi0tbWluaSB7CiAgcGFkZGluZzogN3B4IDRweDsKICB3aWR0aDogNDBweDsKICBmb250LXNpemU6IDEwcHg7CiAgbWFyZ2luLWxlZnQ6IDFweDsKfQoKOjp2LWRlZXAgLmVsLXRhYmxlX19leHBhbmRlZC1jZWxsIHsKICBwYWRkaW5nOiA2cHggODBweDsKfQoKLm9yZGVyLWdvb2RzIHsKICBkaXNwbGF5OiBmbGV4OwogIGp1c3RpZnktY29udGVudDogc3BhY2UtYXJvdW5kOwogIGp1c3RpZnktaXRlbXM6IGNlbnRlcjsKICBhbGlnbi1pdGVtczpjZW50ZXI7CiAgcGFkZGluZzogNnB4IDA7Cn0KCi5uYW1lIHsKICB3aWR0aDogNDAwcHg7Cn0KCi5zcGVjIHsKICB3aWR0aDogMTgwcHg7Cn0KCi5wcmljZSB7CiAgd2lkdGg6IDEyMHB4Owp9CgoubnVtIHsKICB3aWR0aDogMTIwcHg7Cn0K"},{"version":3,"sources":["order.vue"],"names":[],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AAoPA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA","file":"order.vue","sourceRoot":"src/views/mall","sourcesContent":["<template>\n  <div class=\"app-container\">\n\n    <!-- 查询和其他操作 -->\n    <div class=\"filter-container\">\n      <el-input v-model=\"listQuery.nickname\" clearable class=\"filter-item\" style=\"width: 160px;\" :placeholder=\"$t('mall_order.placeholder.filter_nickname')\" />\n      <el-input v-model=\"listQuery.consignee\" clearable class=\"filter-item\" style=\"width: 160px;\" :placeholder=\"$t('mall_order.placeholder.filter_consignee')\" />\n      <el-input v-model=\"listQuery.orderSn\" clearable class=\"filter-item\" style=\"width: 160px;\" :placeholder=\"$t('mall_order.placeholder.filter_order_sn')\" />\n      <el-date-picker v-model=\"listQuery.timeArray\" type=\"datetimerange\" value-format=\"yyyy-MM-dd HH:mm:ss\" class=\"filter-item\" :range-separator=\"$t('mall_order.text.date_range_separator')\" :start-placeholder=\"$t('mall_order.placeholder.filter_time_start')\" :end-placeholder=\"$t('mall_order.placeholder.filter_time_end')\" :picker-options=\"pickerOptions\" />\n      <el-select v-model=\"listQuery.orderStatusArray\" multiple style=\"width: 200px\" class=\"filter-item\" :placeholder=\"$t('mall_order.placeholder.filter_order_status')\">\n        <el-option v-for=\"(key, value) in statusMap\" :key=\"key\" :label=\"key\" :value=\"value\" />\n      </el-select>\n      <el-button v-permission=\"['GET /admin/order/list']\" class=\"filter-item\" type=\"primary\" icon=\"el-icon-search\" @click=\"handleFilter\">{{ $t('app.button.search') }}</el-button>\n      <el-button :loading=\"downloadLoading\" class=\"filter-item\" type=\"primary\" icon=\"el-icon-download\" @click=\"handleDownload\">{{ $t('app.button.download') }}</el-button>\n    </div>\n\n    <!-- 查询结果 -->\n    <el-table v-loading=\"listLoading\" :data=\"list\" :element-loading-text=\"$t('app.message.list_loading')\" border fit highlight-current-row>\n\n      <el-table-column type=\"expand\">\n        <template slot-scope=\"props\">\n          <div v-for=\"item in props.row.goodsVoList\" :key=\"item.id\" class=\"order-goods\">\n            <div class=\"picture\">\n              <img :src=\"item.picUrl\" width=\"40\">\n            </div>\n            <div class=\"name\">\n              {{ $t('mall_order.text.expand_goods_name', { goods_name: item.goodsName }) }}\n            </div>\n            <div class=\"spec\">\n              {{ $t('mall_order.text.expand_specifications', { specifications: item.specifications.join('-') }) }}\n            </div>\n            <div class=\"price\">\n              {{ $t('mall_order.text.expand_unit_price', { price: item.price }) }}\n            </div>\n            <div class=\"num\">\n              {{ $t('mall_order.text.expand_number', { number: item.number }) }}\n            </div>\n            <div class=\"price\">\n              {{ $t('mall_order.text.expand_subtotal_price', { price: item.price * item.number }) }}\n            </div>\n          </div>\n        </template>\n      </el-table-column>\n\n      <el-table-column align=\"center\" min-width=\"120\" :label=\"$t('mall_order.table.order_sn')\" prop=\"orderSn\" />\n\n      <el-table-column align=\"center\" :label=\"$t('mall_order.table.avatar')\" width=\"80\">\n        <template slot-scope=\"scope\">\n          <el-avatar :src=\"scope.row.avatar\" />\n        </template>\n      </el-table-column>\n\n      <el-table-column align=\"center\" :label=\"$t('mall_order.table.user_name')\" prop=\"userName\" />\n\n      <el-table-column align=\"center\" :label=\"$t('mall_order.table.add_time')\" prop=\"addTime\" min-width=\"100\">\n        <template slot-scope=\"scope\">\n          {{ (scope.row.addTime || '').substring(0, 10) }}\n        </template>\n      </el-table-column>\n      <el-table-column align=\"center\" :label=\"$t('mall_order.table.order_status')\" prop=\"orderStatus\">\n        <template slot-scope=\"scope\">\n          <el-tag>{{ scope.row.orderStatus | orderStatusFilter }}</el-tag>\n        </template>\n      </el-table-column>\n\n      <el-table-column align=\"center\" :label=\"$t('mall_order.table.order_price')\" prop=\"orderPrice\">\n        <template slot-scope=\"scope\">\n          {{ scope.row.orderPrice }} 元\n        </template>\n      </el-table-column>\n\n      <el-table-column align=\"center\" :label=\"$t('mall_order.table.actual_price')\" prop=\"actualPrice\">\n        <template slot-scope=\"scope\">\n          {{ scope.row.actualPrice }} 元\n        </template>\n      </el-table-column>\n\n      <el-table-column align=\"center\" :label=\"$t('mall_order.table.pay_time')\" prop=\"payTime\" />\n\n      <el-table-column align=\"center\" :label=\"$t('mall_order.table.consignee')\" prop=\"consignee\">\n        <template slot-scope=\"scope\">\n          <span style=\"color:red; font-weight:bold;\">{{ scope.row.consignee }}</span>\n        </template>\n      </el-table-column>\n\n      <el-table-column align=\"center\" :label=\"$t('mall_order.table.mobile')\" prop=\"mobile\" min-width=\"100\" />\n\n      <el-table-column align=\"center\" :label=\"$t('mall_order.table.ship_sn')\" prop=\"shipSn\" />\n\n      <el-table-column align=\"center\" :label=\"$t('mall_order.table.ship_channel')\" prop=\"shipChannel\" />\n\n      <el-table-column align=\"center\" :label=\"$t('mall_order.table.actions')\" width=\"250\" class-name=\"oper\">\n        <template slot-scope=\"scope\">\n          <el-button type=\"primary\" size=\"mini\" @click=\"handleDetail(scope.row)\">{{ $t('app.button.detail') }}</el-button>\n          <el-button type=\"danger\" size=\"mini\" @click=\"handleDelete(scope.row)\">{{ $t('app.button.delete') }}</el-button>\n          <el-button type=\"warning\" size=\"mini\" @click=\"handlePay(scope.row)\">{{ $t('mall_order.button.pay') }}</el-button>\n          <el-button type=\"primary\" size=\"mini\" @click=\"handleShip(scope.row)\">{{ $t('mall_order.button.ship') }}</el-button>\n          <el-button type=\"danger\" size=\"mini\" @click=\"handleRefund(scope.row)\">{{ $t('mall_order.button.refund') }}</el-button>\n        </template>\n      </el-table-column>\n    </el-table>\n\n    <pagination v-show=\"total>0\" :total=\"total\" :page.sync=\"listQuery.page\" :limit.sync=\"listQuery.limit\" @pagination=\"getList\" />\n\n    <!-- 订单详情对话框 -->\n    <el-dialog :visible.sync=\"orderDialogVisible\" :title=\"$t('mall_order.dialog.detail')\" width=\"800\">\n      <section ref=\"print\">\n        <el-form :data=\"orderDetail\" label-position=\"left\">\n          <el-form-item :label=\"$t('mall_order.form.detail_order_sn')\">\n            <span>{{ orderDetail.order.orderSn }}</span>\n          </el-form-item>\n          <el-form-item :label=\"$t('mall_order.form.detail_order_status')\">\n            <el-tag>{{ orderDetail.order.orderStatus | orderStatusFilter }}</el-tag>\n          </el-form-item>\n          <el-form-item :label=\"$t('mall_order.form.detail_user_nickname')\">\n            <span>{{ orderDetail.user.nickname }}</span>\n          </el-form-item>\n          <el-form-item :label=\"$t('mall_order.form.detail_message')\">\n            <span>{{ orderDetail.order.message }}</span>\n          </el-form-item>\n          <el-form-item :label=\"$t('mall_order.form.detail_receiving_info')\">\n            <span>{{ $t('mall_order.text.detail_consigne', { consignee: orderDetail.order.consignee }) }}</span>\n            <span>{{ $t('mall_order.text.detail_mobile', { mobile: orderDetail.order.mobile }) }}</span>\n            <span>{{ $t('mall_order.text.detail_address', { address: orderDetail.order.address }) }}</span>\n          </el-form-item>\n          <el-form-item :label=\"$t('mall_order.form.detail_goods')\">\n            <el-table :data=\"orderDetail.orderGoods\" border fit highlight-current-row>\n              <el-table-column align=\"center\" :label=\"$t('mall_order.table.detail_goods_name')\" prop=\"goodsName\" />\n              <el-table-column align=\"center\" :label=\"$t('mall_order.table.detail_goods_sn')\" prop=\"goodsSn\" />\n              <el-table-column align=\"center\" :label=\"$t('mall_order.table.detail_goods_specifications')\" prop=\"specifications\" />\n              <el-table-column align=\"center\" :label=\"$t('mall_order.table.detail_goods_price')\" prop=\"price\" />\n              <el-table-column align=\"center\" :label=\"$t('mall_order.table.detail_goods_number')\" prop=\"number\" />\n              <el-table-column align=\"center\" :label=\"$t('mall_order.table.detail_goods_pic_url')\" prop=\"picUrl\">\n                <template slot-scope=\"scope\">\n                  <img :src=\"scope.row.picUrl\" width=\"40\">\n                </template>\n              </el-table-column>\n            </el-table>\n          </el-form-item>\n          <el-form-item :label=\"$t('mall_order.form.detail_price_info')\">\n            <span>\n              {{ $t('mall_order.text.detail_price_info', {\n                actual_price: orderDetail.order.actualPrice,\n                goods_price: orderDetail.order.goodsPrice,\n                freight_price: orderDetail.order.freightPrice,\n                coupon_price: orderDetail.order.couponPrice,\n                integral_price: orderDetail.order.integralPrice\n              }) }}\n            </span>\n          </el-form-item>\n          <el-form-item :label=\"$t('mall_order.form.detail_pay_info')\">\n            <span>{{ $t('mall_order.text.detail_pay_channel', { pay_channel: '微信支付' }) }}</span>\n            <span>{{ $t('mall_order.text.detail_pay_time', { pay_time: orderDetail.order.payTime }) }}</span>\n          </el-form-item>\n          <el-form-item :label=\"$t('mall_order.form.detail_ship_info')\">\n            <span>{{ $t('mall_order.text.detail_ship_channel', { ship_channel: orderDetail.order.shipChannel }) }}</span>\n            <span>{{ $t('mall_order.text.detail_ship_sn', { ship_sn: orderDetail.order.shipSn }) }}</span>\n            <span>{{ $t('mall_order.text.detail_ship_time', { ship_time: orderDetail.order.shipTime }) }}</span>\n          </el-form-item>\n          <el-form-item :label=\"$t('mall_order.form.detail_refund_info')\">\n            <span>{{ $t('mall_order.text.detail_refund_amount', { refund_amount: orderDetail.order.refundAmount }) }}</span>\n            <span>{{ $t('mall_order.text.detail_refund_type', { refund_type: orderDetail.order.refundType }) }}</span>\n            <span>{{ $t('mall_order.text.detail_refund_content', { refund_content: orderDetail.order.refundContent }) }}</span>\n            <span>{{ $t('mall_order.text.detail_refund_time', { refund_time: orderDetail.order.refundTime }) }}</span>\n          </el-form-item>\n          <el-form-item :label=\"$t('mall_order.form.detail_receipt_info')\">\n            <span>{{ $t('mall_order.text.detail_confirm_time', { confirm_time: orderDetail.order.confirmTime }) }}</span>\n          </el-form-item>\n        </el-form>\n      </section>\n      <span slot=\"footer\" class=\"dialog-footer\">\n        <el-button @click=\"orderDialogVisible = false\">{{ $t('mall_order.button.detail_cancel') }}</el-button>\n        <el-button type=\"primary\" @click=\"printOrder\">{{ $t('mall_order.button.detail_print') }}</el-button>\n      </span>\n    </el-dialog>\n\n    <!-- 收款对话框 -->\n    <el-dialog :visible.sync=\"payDialogVisible\" :title=\"$t('mall_order.dialog.pay')\" width=\"40%\" center>\n      <el-form ref=\"payForm\" :model=\"payForm\" status-icon label-position=\"left\" label-width=\"100px\">\n        <div style=\"margin-bottom: 10px;\">\n          {{ $t('mall_order.message.pay_confirm', { order_sn: payForm.orderSn }) }}\n        </div>\n        <el-form-item :label=\"$t('mall_order.form.pay_old_money')\" prop=\"oldMoney\">\n          <el-input-number v-model=\"payForm.oldMoney\" :controls=\"false\" disabled />\n        </el-form-item>\n        <el-form-item :label=\"$t('mall_order.form.pay_new_money')\" prop=\"newMoney\">\n          <el-input-number v-model=\"payForm.newMoney\" :controls=\"false\" />\n        </el-form-item>\n      </el-form>\n      <el-table :data=\"payForm.goodsList\">\n        <el-table-column property=\"goodsName\" :label=\"$t('mall_order.table.pay_goods_name')\" />\n        <el-table-column :label=\"$t('mall_order.table.pay_goods_specifications')\">\n          <template slot-scope=\"scope\">\n            {{ scope.row.specifications.join('-') }}\n          </template>\n        </el-table-column>\n        <el-table-column property=\"onumber\" width=\"100\" :label=\"$t('mall_order.table.pay_goods_number')\" />\n        <!-- <el-table-column label=\"实际数量\" width=\"100\">\n          <template slot-scope=\"scope\">\n            <el-input-number v-model=\"scope.row.number\" :min=\"0\" :controls=\"false\" />\n          </template>\n        </el-table-column> -->\n      </el-table>\n      <div slot=\"footer\" class=\"dialog-footer\">\n        <el-button @click=\"payDialogVisible = false\">{{ $t('app.button.cancel') }}</el-button>\n        <el-button type=\"primary\" @click=\"confirmPay\">{{ $t('app.button.confirm') }}</el-button>\n      </div>\n    </el-dialog>\n\n    <!-- 发货对话框 -->\n    <el-dialog :visible.sync=\"shipDialogVisible\" :title=\"$t('mall_order.dialog.ship')\">\n      <el-form ref=\"shipForm\" :model=\"shipForm\" status-icon label-position=\"left\" label-width=\"100px\" style=\"width: 400px; margin-left:50px;\">\n        <el-form-item :label=\"$t('mall_order.form.ship_channel')\" prop=\"shipChannel\">\n          <el-select v-model=\"shipForm.shipChannel\" :placeholder=\"$t('mall_order.placeholder.ship_channel')\">\n            <el-option v-for=\"item in channels\" :key=\"item.code\" :label=\"item.name\" :value=\"item.code\" />\n          </el-select>\n        </el-form-item>\n        <el-form-item :label=\"$t('mall_order.form.ship_sn')\" prop=\"shipSn\">\n          <el-input v-model=\"shipForm.shipSn\" />\n        </el-form-item>\n      </el-form>\n      <div slot=\"footer\" class=\"dialog-footer\">\n        <el-button @click=\"shipDialogVisible = false\">{{ $t('app.button.cancel') }}</el-button>\n        <el-button type=\"primary\" @click=\"confirmShip\">{{ $t('app.button.confirm') }}</el-button>\n      </div>\n    </el-dialog>\n\n    <!-- 退款对话框 -->\n    <el-dialog :visible.sync=\"refundDialogVisible\" :title=\"$t('mall_order.dialog.refund')\">\n      <el-form ref=\"refundForm\" :model=\"refundForm\" status-icon label-position=\"left\" label-width=\"100px\" style=\"width: 400px; margin-left:50px;\">\n        <el-form-item :label=\"$t('mall_order.form.refund_money')\" prop=\"refundMoney\">\n          <el-input v-model=\"refundForm.refundMoney\" :disabled=\"true\" />\n        </el-form-item>\n      </el-form>\n      <div slot=\"footer\" class=\"dialog-footer\">\n        <el-button @click=\"refundDialogVisible = false\">{{ $t('app.button.cancel') }}</el-button>\n        <el-button type=\"primary\" @click=\"confirmRefund\">{{ $t('app.button.confirm') }}</el-button>\n      </div>\n    </el-dialog>\n\n  </div>\n</template>\n\n<style lang=\"scss\" scoped>\n.el-table--medium th, .el-table--medium td {\n    padding: 3px 0;\n}\n\n.el-input-number--medium {\n  width: 100%;\n}\n\n.oper .el-button--mini {\n  padding: 7px 4px;\n  width: 40px;\n  font-size: 10px;\n  margin-left: 1px;\n}\n\n::v-deep .el-table__expanded-cell {\n  padding: 6px 80px;\n}\n\n.order-goods {\n  display: flex;\n  justify-content: space-around;\n  justify-items: center;\n  align-items:center;\n  padding: 6px 0;\n}\n\n.name {\n  width: 400px;\n}\n\n.spec {\n  width: 180px;\n}\n\n.price {\n  width: 120px;\n}\n\n.num {\n  width: 120px;\n}\n</style>\n\n<script>\nimport { detailOrder, listOrder, listChannel, refundOrder, payOrder, deleteOrder, shipOrder } from '@/api/order'\nimport Pagination from '@/components/Pagination' // Secondary package based on el-pagination\nimport checkPermission from '@/utils/permission' // 权限判断函数\n\nconst statusMap = {\n  101: '未付款',\n  102: '用户取消',\n  103: '系统取消',\n  201: '已付款',\n  202: '申请退款',\n  203: '已退款',\n  301: '已发货',\n  401: '用户收货',\n  402: '系统收货'\n}\n\nexport default {\n  name: 'Order',\n  components: { Pagination },\n  filters: {\n    orderStatusFilter(status) {\n      return statusMap[status]\n    }\n  },\n  data() {\n    return {\n      list: [],\n      total: 0,\n      listLoading: true,\n      listQuery: {\n        page: 1,\n        limit: 20,\n        nickname: undefined,\n        consignee: undefined,\n        orderSn: undefined,\n        timeArray: [],\n        orderStatusArray: [],\n        sort: 'add_time',\n        order: 'desc'\n      },\n      pickerOptions: {\n        shortcuts: [{\n          text: '最近一周',\n          onClick(picker) {\n            const end = new Date()\n            const start = new Date()\n            start.setTime(start.getTime() - 3600 * 1000 * 24 * 7)\n            picker.$emit('pick', [start, end])\n          }\n        }, {\n          text: '最近一个月',\n          onClick(picker) {\n            const end = new Date()\n            const start = new Date()\n            start.setTime(start.getTime() - 3600 * 1000 * 24 * 30)\n            picker.$emit('pick', [start, end])\n          }\n        }, {\n          text: '最近三个月',\n          onClick(picker) {\n            const end = new Date()\n            const start = new Date()\n            start.setTime(start.getTime() - 3600 * 1000 * 24 * 90)\n            picker.$emit('pick', [start, end])\n          }\n        }]\n      },\n      statusMap,\n      orderDialogVisible: false,\n      orderDetail: {\n        order: {},\n        user: {},\n        orderGoods: []\n      },\n      shipForm: {\n        orderId: undefined,\n        shipChannel: undefined,\n        shipSn: undefined\n      },\n      shipDialogVisible: false,\n      payForm: {\n        orderId: undefined,\n        orderSn: '',\n        oldMoney: 0,\n        newMoney: 0,\n        goodsList: []\n      },\n      payDialogVisible: false,\n      refundForm: {\n        orderId: undefined,\n        refundMoney: undefined\n      },\n      refundDialogVisible: false,\n      downloadLoading: false,\n      channels: []\n    }\n  },\n  created() {\n    this.getList()\n    this.getChannel()\n  },\n  methods: {\n    checkPermission,\n    getList() {\n      this.listLoading = true\n      if (this.listQuery.timeArray && this.listQuery.timeArray.length === 2) {\n        this.listQuery.start = this.listQuery.timeArray[0]\n        this.listQuery.end = this.listQuery.timeArray[1]\n      } else {\n        this.listQuery.start = null\n        this.listQuery.end = null\n      }\n      if (this.listQuery.orderId) {\n        detailOrder(this.listQuery.orderId).then(response => {\n          this.list = []\n          if (response.data.data.order) {\n            this.list.push(response.data.data.order)\n            this.total = 1\n            this.listLoading = false\n          }\n        }).catch(() => {\n          this.list = []\n          this.total = 0\n          this.listLoading = false\n        })\n      } else {\n        listOrder(this.listQuery).then(response => {\n          this.list = response.data.data.list\n          this.total = response.data.data.total\n          this.listLoading = false\n        }).catch(() => {\n          this.list = []\n          this.total = 0\n          this.listLoading = false\n        })\n      }\n    },\n    getChannel() {\n      listChannel().then(response => {\n        this.channels = response.data.data\n      })\n    },\n    handleFilter() {\n      this.listQuery.page = 1\n      this.getList()\n    },\n    handleDetail(row) {\n      detailOrder(row.id).then(response => {\n        this.orderDetail = response.data.data\n      })\n      this.orderDialogVisible = true\n    },\n    handlePay(row) {\n      this.payForm.orderId = row.id\n      this.payForm.orderSn = row.orderSn\n      this.payForm.oldMoney = row.actualPrice\n      this.payForm.newMoney = row.actualPrice\n      this.payForm.goodsList = row.goodsVoList\n      this.payForm.goodsList.forEach(element => {\n        element.onumber = element.number\n      })\n      this.payDialogVisible = true\n    },\n    confirmPay() {\n      if (this.payForm.oldMoney !== this.payForm.newMoney) {\n        const diff = this.payForm.newMoney - this.payForm.oldMoney\n        this.$confirm('差额 ' + diff + '元， 是否确认提交')\n          .then(_ => {\n            this.confirmPay2()\n          })\n          .catch(_ => {})\n      } else {\n        this.confirmPay2()\n      }\n    },\n    confirmPay2() {\n      payOrder(this.payForm).then(response => {\n        this.$notify.success({\n          title: '成功',\n          message: '订单收款操作成功'\n        })\n        this.getList()\n      }).catch(response => {\n        this.$notify.error({\n          title: '失败',\n          message: response.data.errmsg\n        })\n      }).finally(() => {\n        this.payDialogVisible = false\n      })\n    },\n    handleShip(row) {\n      this.shipForm.orderId = row.id\n      this.shipForm.shipChannel = row.shipChannel\n      this.shipForm.shipSn = row.shipSn\n\n      this.shipDialogVisible = true\n      this.$nextTick(() => {\n        this.$refs['shipForm'].clearValidate()\n      })\n    },\n    confirmShip() {\n      this.$refs['shipForm'].validate((valid) => {\n        if (valid) {\n          shipOrder(this.shipForm).then(response => {\n            this.shipDialogVisible = false\n            this.$notify.success({\n              title: '成功',\n              message: '确认发货成功'\n            })\n            this.getList()\n          }).catch(response => {\n            this.$notify.error({\n              title: '失败',\n              message: response.data.errmsg\n            })\n          })\n        }\n      })\n    },\n    handleDelete(row) {\n      deleteOrder({ orderId: row.id }).then(response => {\n        this.$notify.success({\n          title: '成功',\n          message: '订单删除成功'\n        })\n        this.getList()\n      }).catch(response => {\n        this.$notify.error({\n          title: '失败',\n          message: response.data.errmsg\n        })\n      })\n    },\n    handleRefund(row) {\n      this.refundForm.orderId = row.id\n      this.refundForm.refundMoney = row.actualPrice\n\n      this.refundDialogVisible = true\n      this.$nextTick(() => {\n        this.$refs['refundForm'].clearValidate()\n      })\n    },\n    confirmRefund() {\n      this.$refs['refundForm'].validate((valid) => {\n        if (valid) {\n          refundOrder(this.refundForm).then(response => {\n            this.refundDialogVisible = false\n            this.$notify.success({\n              title: '成功',\n              message: '确认退款成功'\n            })\n            this.getList()\n          }).catch(response => {\n            this.$notify.error({\n              title: '失败',\n              message: response.data.errmsg\n            })\n          })\n        }\n      })\n    },\n    handleDownload() {\n      this.downloadLoading = true\n      import('@/vendor/Export2Excel').then(excel => {\n        const tHeader = ['订单ID', '订单编号', '用户ID', '订单状态', '是否删除', '收货人', '收货联系电话', '收货地址']\n        const filterVal = ['id', 'orderSn', 'userId', 'orderStatus', 'isDelete', 'consignee', 'mobile', 'address']\n        excel.export_json_to_excel2(tHeader, this.list, filterVal, '订单信息')\n        this.downloadLoading = false\n      })\n    },\n    printOrder() {\n      this.$print(this.$refs.print)\n      this.orderDialogVisible = false\n    }\n  }\n}\n</script>\n"]}]}